<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catálogo de Productos Capilares</title>
    
    <!-- Google Fonts para un estilo elegante -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">

    <style>
        /* --- ESTILOS CSS --- */
        
        /* Reseteo y estilos base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Lato', sans-serif;
            background-color: #fdf8f5; /* Un color rosa pálido/beige muy sutil */
            color: #444;
            line-height: 1.6;
        }

        /* Contenedor principal */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Cabecera */
        header {
            text-align: center;
            padding: 40px 0;
        }

        header h1 {
            font-family: 'Playfair Display', serif;
            font-size: 2.8rem;
            color: #333;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.1rem;
            color: #666;
        }

        /* Contenedor de la cuadrícula de productos */
        #product-grid {
            display: grid;
            /* Columnas responsivas: 3 en escritorio, 2 en tablet, 1 en móvil */
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 30px; /* Espacio entre tarjetas */
            padding: 20px 0;
        }
        
        /* Mensaje de carga */
        #loading-message {
            text-align: center;
            font-size: 1.2rem;
            padding: 50px;
            color: #888;
        }

        /* Tarjeta de producto individual */
        .product-card {
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.07);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .product-card img {
            width: 100%;
            height: 280px; /* Altura fija para la imagen */
            object-fit: cover; /* Asegura que la imagen cubra el espacio sin deformarse */
            display: block;
        }

        .product-info {
            padding: 25px;
            flex-grow: 1; /* Permite que este div crezca y empuje el footer hacia abajo */
            display: flex;
            flex-direction: column;
        }

        .product-info .brand {
            font-size: 0.8rem;
            font-weight: 700;
            color: #c59d5f; /* Un tono dorado/bronce */
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 5px;
        }

        .product-info h2 {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            color: #222;
            margin-bottom: 10px;
        }

        .product-info .description {
            font-size: 0.95rem;
            color: #666;
            flex-grow: 1; /* Hace que la descripción ocupe el espacio disponible */
            margin-bottom: 15px;
        }

        .product-details {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: auto; /* Empuja esta sección al final de .product-info */
        }

        .product-info .price {
            font-size: 1.4rem;
            font-weight: 700;
            color: #333;
        }
        
        .product-info .stock {
            font-size: 0.9rem;
            font-weight: bold;
            padding: 5px 10px;
            border-radius: 5px;
        }
        
        .stock.disponible {
            background-color: #e0f2f1; /* Verde menta pálido */
            color: #00796b;
        }

        .stock.pocas-unidades {
            background-color: #fff3e0; /* Naranja pálido */
            color: #ef6c00;
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 30px;
            margin-top: 40px;
            border-top: 1px solid #eee;
            color: #999;
        }
        
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>Nuestro Catálogo</h1>
            <p>Productos de alta gama para el cuidado de tu cabello</p>
        </header>

        <main>
            <!-- Aquí se insertarán los productos dinámicamente -->
            <div id="product-grid">
                <p id="loading-message">Cargando productos...</p>
            </div>
        </main>

        <footer>
            <p>© 2024 Tu Marca - Todos los derechos reservados.</p>
        </footer>
    </div>

    <script>
        // --- CÓDIGO JAVASCRIPT ---

        // 1. URL original de tu Google Sheet.
        const originalSheetURL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQrbcaFnev1zv2hLmC--6nuzSuPNM_e7jfGue8a31i91VwcgDLdQ5N1Y_i2lEfVJdW-L_qNOI0sslhw/pub?gid=0&single=true&output=csv';
        
        // 2. URL del proxy para evitar errores de CORS.
        const proxyURL = 'https://api.allorigins.win/raw?url=';

        // 3. URL final que combina el proxy y la URL de tu hoja (codificada).
        const sheetURL = proxyURL + encodeURIComponent(originalSheetURL);

        // Ejecutamos el código cuando el contenido del DOM esté completamente cargado
        document.addEventListener('DOMContentLoaded', () => {
            fetchProducts();
        });

        async function fetchProducts() {
            const productGrid = document.getElementById('product-grid');
            const loadingMessage = document.getElementById('loading-message');

            try {
                const response = await fetch(sheetURL);
                if (!response.ok) {
                    throw new Error('Error al cargar los datos desde el proxy.');
                }
                const csvText = await response.text();
                
                // Procesamos el texto CSV
                const products = parseCSV(csvText);

                // Ocultamos el mensaje de "Cargando..."
                loadingMessage.style.display = 'none';

                // Mostramos cada producto
                products.forEach(product => {
                    const card = createProductCard(product);
                    productGrid.appendChild(card);
                });

            } catch (error) {
                console.error('Hubo un problema:', error);
                loadingMessage.textContent = 'No se pudieron cargar los productos. Por favor, inténtalo de nuevo más tarde.';
            }
        }

        function parseCSV(text) {
            const lines = text.split(/\r?\n/); // Divide por líneas
            const headers = lines[0].split(',');
            const data = [];

            for (let i = 1; i < lines.length; i++) {
                if (!lines[i]) continue; // Salta líneas vacías
                
                const values = lines[i].split(',');
                const entry = {};

                headers.forEach((header, index) => {
                    entry[header.trim()] = values[index] ? values[index].trim() : '';
                });

                data.push(entry);
            }
            return data;
        }

        function createProductCard(product) {
            const card = document.createElement('div');
            card.className = 'product-card';

            let stockClass = '';
            const stockText = (product.Stock || '').toLowerCase().replace(/\s+/g, '-');
            if (stockText === 'disponible') {
                stockClass = 'disponible';
            } else if (stockText === 'pocas-unidades') {
                stockClass = 'pocas-unidades';
            }

            // Usamos los nombres de las columnas de tu Excel
            card.innerHTML = `
                <img src="${product.URL_Imagen}" alt="${product.NombreProducto}">
                <div class="product-info">
                    <span class="brand">${product.Marca}</span>
                    <h2>${product.NombreProducto}</h2>
                    <p class="description">${product.Descripcion}</p>
                    <div class="product-details">
                         <span class="stock ${stockClass}">${product.Stock}</span>
                         <span class="price">${product.Precio}</span>
                    </div>
                </div>
            `;
            return card;
        }

    </script>
</body>
</html>
